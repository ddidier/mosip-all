"$id": ./common.yaml
"$schema": https://json-schema.org/draft/2020-12/schema
title: Common properties
description: Common properties shared across schemas 
$defs:
  deviceSubId:
    type: integer
    description: "[Device SubId](https://docs.mosip.io/1.2.0/biometrics/secure-biometric-interface#device-subid)."
  bioType: 
    type: string
    description: 
    enum:
      - Finger
      - Iris
      - Face
  specVersion:
    type: array
    description: Supported SBI versions.
    items:
      type: string
  deviceCode:
    type: string
    description: Code generated by the Device Provider.
  certification:
    type: string
    description: Certification level.
    enum: 
      - L0
      - L1
  timeout:
    type: integer
    description: Timeout in milliseconds
    default: 300000 
  captureTime:
    type: string
    description: Capture time in ISO format.
  deviceId:
    type: string
    description: Internal ID of the device
  env:
    type: string
    description: Target environment.
    enum:
      - Staging 
      - Developer
      - Pre-Production
      - Production
  purpose:
    description: 
    type: string
    enum:
      - Auth
      - Registration 
  deviceStatus:
     type: string
     description: 
     enum:
       - Ready
       - Busy
       - Not Ready
       - Not Registered
  error:
    type: object 
    properties:
      errorCode:
        type: string
        description: Error codes with their description. 
        enum:
          - 0 - Success
          - 100 - Device not registered
          - 101 -  Unable to detect a biometric object
          - 102 - Technical error during extraction
          - 103 - Device tamper detected
          - 104 - Unable to connect to management server
          - 105 - Image orientation error
          - 106 - Device not found
          - 107 - Device public key expired
          - 108 - Domain public key missing
          - 109 - Requested number of biometric (Finger/IRIS) not supported
          - 202 - No device connected
          - 5xx - Custom error codes implemented by [Device Provider](https://docs.mosip.io/1.2.0/partners#partner-types). 
      errorInfo: 
        type: string
        description: ""

  bio:
    type: object
    properties:
      type: 
        description: Type of the biometric data.
        type: string
      count:
        description: Finger/iris count. 1 in case of face.
        type: integer
      bioSubType:
        description: "[Subtypes](https://docs.mosip.io/1.2.0/biometrics/secure-biometric-interface#biometric-subtype)."
        type: array
        items:
          type: string
      requestedScore:
        description: 
        type: string
      deviceId:  
        $ref: '#/$defs/deviceId'
      deviceSubId:
        $ref: '#/$defs/deviceSubId'
      previousHash:
        type: string
        description: Hash of the previous block.

  bioRCapture:
    type: object
    properties:
      type: 
        description: Type of the biometric data.
        type: string
      count:
        description: Finger/iris count. 1 in case of face.
        type: integer
      bioSubType:
        description: "[Subtypes](https://docs.mosip.io/1.2.0/biometrics/secure-biometric-interface#biometric-subtype)."
        type: array
        items:
          type: string
      exception:
        type: array
        description: "Array of [Subtypes](https://docs.mosip.io/1.2.0/biometrics/secure-biometric-interface#biometric-subtype)."
        items:
          type: string
      requestedScore:
        description: 
        type: string
      deviceId:  
        $ref: '#/$defs/deviceId'
      deviceSubId:
        $ref: '#/$defs/deviceSubId'
      previousHash:
        type: string
        description: Hash of the previous block.

  captureBiometrics:
    type: object
    description:
    properties:
      specVersion: 
        $ref: '#/$defs/specVersion'  
      data:
        $ref: '#/$defs/bioData'  
      hash:
        type: string
        description: sha256(sha256 hash in hex format of the previous data block + sha256 hash in hex format of the current data block before encryption)
      sessionKey:
        type: string
        description: Encrypted with MOSIP public key (dynamically selected based on the uri) and encoded session key biometric"
      thumbprint:
        type: string
        description: SHA256 representation of thumbprint of the certificate that was used for encryption of session key. All texts to be treated as uppercase without any spaces or hyphens
      error:
        $ref: '#/$defs/error'     

  rCaptureBiometrics:
    type: object
    description:
    properties:
      specVersion: 
        $ref: '#/$defs/specVersion'  
      data:
        $ref: '#/$defs/rBioData'  
      hash:
        type: string
        description: sha256(sha256 hash in hex format of the previous data block + sha256 hash in hex format of the current data block before encryption)
      error:
        $ref: '#/$defs/error'     

  bioData:
    type: object
    properties:
      digitalId:
        type: string
        description: "[Reference](https://docs.mosip.io/1.2.0/biometrics/secure-biometric-interface#digital-id)."
      deviceCode: 
        $ref: '#/$defs/deviceCode'
      deviceServiceVersion: 
        type: string
        description: SBI version
      bioType: 
        $ref: '#/$defs/bioType'
      bioSubType: 
        type: string
        description: "[Subtypes](https://docs.mosip.io/1.2.0/biometrics/secure-biometric-interface#biometric-subtype)."
      purpose: 
        $ref: '#/$defs/purpose'
      env: 
        $ref: '#/$defs/env'
      domainUri:
        type: string
        description: URI of the auth server.
      bioValue: 
        type: string
        description: Encrypted with session key and base64urlencoded biometric data.
      transactionId: 
        type: string
        description: Unique transaction id.
      timestamp: 
        type: string
        description: Capture datetime in ISO format.
      requestedScore: 
        type: number
        description: Floating point number to represent the minimum required score for the capture.
      qualityScore: 
        type: number
        description: Floating point number representing the score for the current capture.

  rBioData:
    type: object
    properties:
      digitalId:
        type: string
        description: "[Reference](https://docs.mosip.io/1.2.0/biometrics/secure-biometric-interface#digital-id)."
      bioType: 
        $ref: '#/$defs/bioType'
      deviceCode: 
        $ref: '#/$defs/deviceCode'
      deviceServiceVersion: 
        type: string
        description: SBI version
      bioSubType: 
        type: string
        description: "[Subtypes](https://docs.mosip.io/1.2.0/biometrics/secure-biometric-interface#biometric-subtype)."
      purpose: 
        $ref: '#/$defs/purpose'
      env: 
        $ref: '#/$defs/env'
      bioValue: 
        type: string
        description: Encrypted with session key and base64urlencoded biometric data.
      transactionId: 
        type: string
        description: Unique transaction id.
      timestamp: 
        type: string
        description: Capture datetime in ISO format.
      requestedScore: 
        type: number
        description: Floating point number to represent the minimum required score for the capture.
      qualityScore: 
        type: number
        description: Floating point number representing the score for the current capture.
